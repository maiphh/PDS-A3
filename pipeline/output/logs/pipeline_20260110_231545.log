2026-01-10 23:15:48,558 - pipeline - INFO - ============================================================
2026-01-10 23:15:48,558 - pipeline - INFO - Task 1: Retrieving and Preparing the Data
2026-01-10 23:15:48,559 - pipeline - INFO - ============================================================
2026-01-10 23:15:48,560 - pipeline - INFO - pipeline/data/anonymous-msweb.data already exists locally.
2026-01-10 23:15:48,806 - pipeline - INFO - Interactions DataFrame shape: (98654, 2)
2026-01-10 23:15:48,808 - pipeline - INFO - Attributes DataFrame shape: (294, 3)
2026-01-10 23:15:48,836 - pipeline - INFO - Number of unique users: 32711
2026-01-10 23:15:48,845 - pipeline - INFO - Number of unique pages: 294
2026-01-10 23:15:48,849 - pipeline - INFO - Missing values in interactions:
2026-01-10 23:15:48,853 - pipeline - INFO - 
case_id    0
attr_id    0
dtype: int64
2026-01-10 23:15:48,854 - pipeline - INFO - Missing values in attributes:
2026-01-10 23:15:48,856 - pipeline - INFO - 
attr_id    0
title      0
url        0
dtype: int64
2026-01-10 23:15:48,878 - pipeline - INFO - Duplicate user-page interactions: 0
2026-01-10 23:15:48,884 - pipeline - INFO - ============================================================
2026-01-10 23:15:48,887 - pipeline - INFO - Task 2: Feature Engineering
2026-01-10 23:15:48,889 - pipeline - INFO - ============================================================
2026-01-10 23:15:50,969 - pipeline - INFO - Wide DataFrame shape: (32711, 285)
2026-01-10 23:15:50,970 - pipeline - INFO - ============================================================
2026-01-10 23:15:50,970 - pipeline - INFO - Task 3: Modeling
2026-01-10 23:15:50,971 - pipeline - INFO - ============================================================
2026-01-10 23:15:51,498 - pipeline - INFO - Train: 74862 interactions | Test: 22716 users, 23792 interactions
2026-01-10 23:15:51,503 - pipeline - INFO - Loading/Training models...
2026-01-10 23:15:51,572 - pipeline - INFO - Model loaded from pipeline/output/models\Popularity.pkl
2026-01-10 23:15:51,677 - pipeline - INFO - Model loaded from pipeline/output/models\Random.pkl
2026-01-10 23:15:59,837 - pipeline - INFO - Model loaded from pipeline/output/models\UserCF_k50.pkl
2026-01-10 23:16:00,151 - pipeline - INFO - Model loaded from pipeline/output/models\ItemCF_k50.pkl
2026-01-10 23:16:00,252 - pipeline - INFO - Model loaded from pipeline/output/models\SVD_f50.pkl
2026-01-10 23:16:01,178 - pipeline - INFO - Model loaded from pipeline/output/models\XGBoost_f20.pkl
2026-01-10 23:16:01,417 - pipeline - INFO - Model loaded from pipeline/output/models\DecisionTree_f20.pkl
2026-01-10 23:16:01,543 - pipeline - INFO - Model loaded from pipeline/output/models\DecisionTreeClustered_f20,k5.pkl
2026-01-10 23:16:01,545 - pipeline - INFO - Done!
2026-01-10 23:16:01,545 - pipeline - INFO - ============================================================
2026-01-10 23:16:01,546 - pipeline - INFO - Task 4: Evaluation
2026-01-10 23:16:01,546 - pipeline - INFO - ============================================================
2026-01-10 23:16:01,546 - pipeline - INFO - --- Classifier Evaluation ---
2026-01-10 23:16:01,548 - pipeline - INFO - Evaluating classifier: XGBoost(f=20)...
2026-01-10 23:17:37,355 - pipeline - INFO - --- XGBoost(f=20) Classification Report ---
2026-01-10 23:17:37,398 - pipeline - INFO - 
              precision    recall  f1-score   support

 No Interact       0.85      0.97      0.91    118960
    Interact       0.52      0.15      0.24     23792

    accuracy                           0.83    142752
   macro avg       0.68      0.56      0.57    142752
weighted avg       0.80      0.83      0.80    142752

2026-01-10 23:17:37,399 - pipeline - INFO - Evaluating classifier: DecisionTree(f=20)...
2026-01-10 23:19:06,906 - pipeline - INFO - --- DecisionTree(f=20) Classification Report ---
2026-01-10 23:19:07,019 - pipeline - INFO - 
              precision    recall  f1-score   support

 No Interact       0.88      0.94      0.91    118960
    Interact       0.54      0.36      0.43     23792

    accuracy                           0.84    142752
   macro avg       0.71      0.65      0.67    142752
weighted avg       0.82      0.84      0.83    142752

2026-01-10 23:19:07,019 - pipeline - INFO - Evaluating classifier: DecisionTreeClustered(f=20,k=5)...
2026-01-10 23:19:07,020 - pipeline - INFO - Training KMeans with n_clusters=5...
2026-01-10 23:19:15,161 - pipeline - INFO - KMeans trained. Cluster distribution: [ 3455 16309  4707  5622  2618]
2026-01-10 23:20:52,149 - pipeline - INFO - --- DecisionTreeClustered(f=20,k=5) Classification Report ---
2026-01-10 23:20:52,190 - pipeline - INFO - 
              precision    recall  f1-score   support

 No Interact       0.88      0.94      0.91    118960
    Interact       0.54      0.36      0.43     23792

    accuracy                           0.84    142752
   macro avg       0.71      0.65      0.67    142752
weighted avg       0.82      0.84      0.83    142752

2026-01-10 23:20:52,300 - pipeline - INFO - Classifier results saved to: pipeline/output/evaluations\classifier_comparison_20260110_232052.csv
2026-01-10 23:20:54,262 - pipeline - INFO - Classifier comparison plot saved to: pipeline/output/evaluations\classifier_comparison_20260110_232052.png
2026-01-10 23:20:54,269 - pipeline - INFO - Classifier Results:
2026-01-10 23:20:54,290 - pipeline - INFO - 
                                 Accuracy  Precision  Recall  F1 Score  ROC-AUC
Model                                                                          
XGBoost(f=20)                      0.8348     0.5151  0.1540    0.2371   0.6278
DecisionTree(f=20)                 0.8416     0.5376  0.3565    0.4287   0.5757
DecisionTreeClustered(f=20,k=5)    0.8416     0.5376  0.3552    0.4278   0.5752
2026-01-10 23:20:54,292 - pipeline - INFO - --- Recommender Evaluation ---
2026-01-10 23:20:54,307 - pipeline - INFO - Sampling 500 users for evaluation (out of 22716)
2026-01-10 23:20:54,326 - pipeline - INFO - Evaluating Popularity...
2026-01-10 23:20:54,400 - pipeline - INFO - Evaluated 100/500 users
2026-01-10 23:20:54,446 - pipeline - INFO - Evaluated 200/500 users
2026-01-10 23:20:54,489 - pipeline - INFO - Evaluated 300/500 users
2026-01-10 23:20:54,542 - pipeline - INFO - Evaluated 400/500 users
2026-01-10 23:20:54,615 - pipeline - INFO - Evaluated 500/500 users
2026-01-10 23:20:54,616 - pipeline - INFO - Done!
2026-01-10 23:20:54,617 - pipeline - INFO - Evaluating Random...
2026-01-10 23:20:54,622 - pipeline - INFO - Evaluated 100/500 users
2026-01-10 23:20:54,629 - pipeline - INFO - Evaluated 200/500 users
2026-01-10 23:20:54,638 - pipeline - INFO - Evaluated 300/500 users
2026-01-10 23:20:54,650 - pipeline - INFO - Evaluated 400/500 users
2026-01-10 23:20:54,660 - pipeline - INFO - Evaluated 500/500 users
2026-01-10 23:20:54,661 - pipeline - INFO - Done!
2026-01-10 23:20:54,666 - pipeline - INFO - Evaluating UserCF(k=50)...
2026-01-10 23:21:00,747 - pipeline - INFO - Evaluated 100/500 users
2026-01-10 23:21:05,758 - pipeline - INFO - Evaluated 200/500 users
2026-01-10 23:21:10,979 - pipeline - INFO - Evaluated 300/500 users
2026-01-10 23:21:15,914 - pipeline - INFO - Evaluated 400/500 users
2026-01-10 23:21:20,843 - pipeline - INFO - Evaluated 500/500 users
2026-01-10 23:21:20,843 - pipeline - INFO - Done!
2026-01-10 23:21:20,844 - pipeline - INFO - Evaluating ItemCF(k=50)...
2026-01-10 23:21:20,888 - pipeline - INFO - Evaluated 100/500 users
2026-01-10 23:21:20,932 - pipeline - INFO - Evaluated 200/500 users
2026-01-10 23:21:20,974 - pipeline - INFO - Evaluated 300/500 users
2026-01-10 23:21:21,009 - pipeline - INFO - Evaluated 400/500 users
2026-01-10 23:21:21,065 - pipeline - INFO - Evaluated 500/500 users
2026-01-10 23:21:21,065 - pipeline - INFO - Done!
2026-01-10 23:21:21,066 - pipeline - INFO - Evaluating SVD(f=50)...
2026-01-10 23:21:21,093 - pipeline - INFO - Evaluated 100/500 users
2026-01-10 23:21:21,123 - pipeline - INFO - Evaluated 200/500 users
2026-01-10 23:21:21,152 - pipeline - INFO - Evaluated 300/500 users
2026-01-10 23:21:21,172 - pipeline - INFO - Evaluated 400/500 users
2026-01-10 23:21:21,200 - pipeline - INFO - Evaluated 500/500 users
2026-01-10 23:21:21,201 - pipeline - INFO - Done!
2026-01-10 23:21:21,201 - pipeline - INFO - Evaluating XGBoost(f=20)...
2026-01-10 23:21:32,047 - pipeline - INFO - Evaluated 100/500 users
2026-01-10 23:21:43,049 - pipeline - INFO - Evaluated 200/500 users
2026-01-10 23:21:55,659 - pipeline - INFO - Evaluated 300/500 users
2026-01-10 23:22:08,071 - pipeline - INFO - Evaluated 400/500 users
2026-01-10 23:22:21,265 - pipeline - INFO - Evaluated 500/500 users
2026-01-10 23:22:21,265 - pipeline - INFO - Done!
2026-01-10 23:22:21,265 - pipeline - INFO - Evaluating DecisionTree(f=20)...
2026-01-10 23:22:32,976 - pipeline - INFO - Evaluated 100/500 users
2026-01-10 23:22:44,043 - pipeline - INFO - Evaluated 200/500 users
2026-01-10 23:22:54,099 - pipeline - INFO - Evaluated 300/500 users
2026-01-10 23:23:05,203 - pipeline - INFO - Evaluated 400/500 users
2026-01-10 23:23:17,296 - pipeline - INFO - Evaluated 500/500 users
2026-01-10 23:23:17,297 - pipeline - INFO - Done!
2026-01-10 23:23:17,297 - pipeline - INFO - Evaluating DecisionTreeClustered(f=20,k=5)...
2026-01-10 23:23:28,486 - pipeline - INFO - Evaluated 100/500 users
2026-01-10 23:23:39,885 - pipeline - INFO - Evaluated 200/500 users
2026-01-10 23:23:55,044 - pipeline - INFO - Evaluated 300/500 users
2026-01-10 23:24:13,142 - pipeline - INFO - Evaluated 400/500 users
2026-01-10 23:24:33,024 - pipeline - INFO - Evaluated 500/500 users
2026-01-10 23:24:33,025 - pipeline - INFO - Done!
2026-01-10 23:24:33,033 - pipeline - INFO - Recommender results saved to: pipeline/output/evaluations\recommender_comparison_20260110_232433.csv
2026-01-10 23:24:34,204 - pipeline - INFO - Recommender comparison plot saved to: pipeline/output/evaluations\recommender_comparison_20260110_232433.png
2026-01-10 23:24:34,205 - pipeline - INFO - Recommender Results:
2026-01-10 23:24:34,212 - pipeline - INFO - 
                                 precision@5  recall@5  hit_rate@5  ndcg@5
Model                                                                     
Popularity                            0.1036    0.5000       0.510  0.3697
Random                                0.0044    0.0220       0.022  0.0105
UserCF(k=50)                          0.0664    0.3067       0.320  0.2469
ItemCF(k=50)                          0.1220    0.5858       0.600  0.4263
SVD(f=50)                             0.0168    0.0785       0.084  0.0607
XGBoost(f=20)                         0.0352    0.1645       0.172  0.1101
DecisionTree(f=20)                    0.0468    0.2245       0.234  0.1410
DecisionTreeClustered(f=20,k=5)       0.0460    0.2215       0.230  0.1368
2026-01-10 23:24:34,214 - pipeline - INFO - ============================================================
2026-01-10 23:24:34,214 - pipeline - INFO - Sample Recommendations
2026-01-10 23:24:34,215 - pipeline - INFO - ============================================================
2026-01-10 23:24:34,215 - pipeline - INFO - Recommendations for user index 0:
2026-01-10 23:24:34,215 - pipeline - INFO - Popularity: [8, 34, 4, 18, 17]
2026-01-10 23:24:34,216 - pipeline - INFO - Random: [277, 52, 31, 73, 9]
2026-01-10 23:24:34,275 - pipeline - INFO - UserCF(k=50): [35, 8, 3, 30, 129]
2026-01-10 23:24:34,275 - pipeline - INFO - ItemCF(k=50): [3, 18, 35, 4, 17]
2026-01-10 23:24:34,276 - pipeline - INFO - SVD(f=50): [120, 134, 47, 101, 33]
2026-01-10 23:24:34,472 - pipeline - INFO - XGBoost(f=20): [48, 76, 75, 47, 89]
2026-01-10 23:24:34,638 - pipeline - INFO - DecisionTree(f=20): [66, 129, 17, 4, 40]
2026-01-10 23:24:35,041 - pipeline - INFO - DecisionTreeClustered(f=20,k=5): [66, 75, 77, 129, 17]
